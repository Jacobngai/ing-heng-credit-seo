---
/**
 * Chinese Blog Category Pages (ä¸­æ–‡åšå®¢åˆ†ç±»é¡µé¢)
 * Dynamic routes for blog categories
 */

import BaseLayout from '../../../../layouts/BaseLayout.astro';
import Breadcrumbs from '../../../../components/Breadcrumbs.astro';
import CTAButton from '../../../../components/CTAButton.astro';
import { COMPANY_INFO, SITE_CONFIG } from '../../../../utils/constants';

export async function getStaticPaths() {
  const categories = ['equipment-financing', 'contractor-guides', 'business-growth', 'tax-compliance'];
  return categories.map(slug => ({
    params: { slug }
  }));
}

const lang = 'zh';
const { slug } = Astro.params;

// Define all categories
const categoryMap = {
  'equipment-financing': {
    name: 'è®¾å¤‡èèµ„è´´å£«',
    description: 'é©¬æ¥è¥¿äºšè®¾å¤‡èèµ„çš„ä¸“ä¸šæŠ€å·§å’ŒæŒ‡å—',
    icon: 'ğŸ—ï¸'
  },
  'contractor-guides': {
    name: 'æ‰¿åŒ…å•†æŒ‡å—',
    description: 'æ‰¿åŒ…å•†å’Œå»ºç­‘ä¼ä¸šçš„å¿…å¤‡æŒ‡å—',
    icon: 'ğŸ‘·'
  },
  'business-growth': {
    name: 'ä¼ä¸šå¢é•¿ç­–ç•¥',
    description: 'å»ºç­‘æˆ–ç‰©æµä¸šåŠ¡å¢é•¿çš„ç­–ç•¥',
    icon: 'ğŸ“ˆ'
  },
  'tax-compliance': {
    name: 'ç¨åŠ¡ä¸åˆè§„',
    description: 'è®¾å¤‡èèµ„çš„ç¨æ”¶ä¼˜æƒ å’Œåˆè§„ä¿¡æ¯',
    icon: 'ğŸ“‹'
  },
};

const category = categoryMap[slug];

if (!category) {
  return Astro.redirect('/zh/blog', 301);
}

// Map blog posts to their categories
const allPosts = [
  {
    title: '2025å¹´é©¬æ¥è¥¿äºšè®¾å¤‡èèµ„å®Œæ•´æŒ‡å—',
    excerpt: 'è¯¦ç»†äº†è§£å»ºç­‘è®¾å¤‡èèµ„çš„æ‰€æœ‰çŸ¥è¯†ï¼Œä»ç§Ÿè´­åˆ°ç§Ÿèµé€‰é¡¹ã€‚',
    date: '2025-10-11',
    slug: 'complete-guide-equipment-financing-malaysia',
    category: 'è®¾å¤‡èèµ„è´´å£«',
    readTime: 8,
  },
  {
    title: 'æŒ–æ˜æœºèèµ„ï¼šæ‰¿åŒ…å•†å¦‚ä½•èŠ‚çœ30%è®¾å¤‡æˆæœ¬',
    excerpt: 'æ¢ç´¢ç»è¿‡éªŒè¯çš„ç­–ç•¥ï¼Œé€šè¿‡æ™ºèƒ½èèµ„é™ä½æŒ–æ˜æœºè´­ç½®æˆæœ¬ã€‚',
    date: '2025-10-10',
    slug: 'excavator-financing-save-30-percent',
    category: 'æ‰¿åŒ…å•†æŒ‡å—',
    readTime: 6,
  },
  {
    title: 'ç‰©æµå…¬å¸è´§è½¦èèµ„ï¼šå¿«é€Ÿæ‰¹å‡†ç­–ç•¥',
    excerpt: 'ç”¨è¿™äº›ä¸“å®¶æŠ€å·§åŠ å¿«æ‚¨çš„è´§è½¦èèµ„æ‰¹å‡†ã€‚',
    date: '2025-10-09',
    slug: 'lorry-financing-fast-approval-strategies',
    category: 'è®¾å¤‡èèµ„è´´å£«',
    readTime: 7,
  },
  {
    title: 'å‰è½¦ç§Ÿèµ vs è´­ä¹°ï¼šå“ªä¸ªé€‰é¡¹é€‚åˆæ‚¨çš„ä»“åº“ï¼Ÿ',
    excerpt: 'æ¯”è¾ƒç§Ÿèµä¸è´­ä¹°å‰è½¦çš„åˆ©å¼Šã€‚',
    date: '2025-10-08',
    slug: 'forklift-leasing-vs-buying-guide',
    category: 'ä¼ä¸šå¢é•¿ç­–ç•¥',
    readTime: 7,
  },
  {
    title: 'è®¾å¤‡èèµ„çš„ç¨æ”¶ä¼˜æƒ ï¼š2025å¹´æœ€å¤§åŒ–æ‚¨çš„æ‰£é™¤é¢',
    excerpt: 'äº†è§£é©¬æ¥è¥¿äºšè®¾å¤‡èèµ„çš„ç¨æ”¶ä¼˜åŠ¿ã€‚',
    date: '2025-10-07',
    slug: 'tax-benefits-equipment-financing-2025',
    category: 'ç¨åŠ¡ä¸åˆè§„',
    readTime: 8,
  },
  {
    title: 'å»ºç­‘å…¬å¸ç°é‡‘æµç®¡ç†ï¼š5ä¸ªå…³é”®ç­–ç•¥',
    excerpt: 'åœ¨èèµ„æ˜‚è´µå»ºç­‘è®¾å¤‡çš„åŒæ—¶æŒæ¡ç°é‡‘æµç®¡ç†ã€‚',
    date: '2025-10-06',
    slug: 'cash-flow-management-construction',
    category: 'ä¼ä¸šå¢é•¿ç­–ç•¥',
    readTime: 9,
  },
];

// Filter posts by category
const categoryPosts = allPosts.filter(post => post.category === category.name);

// Breadcrumb navigation
const breadcrumbItems = [
  { label: 'é¦–é¡µ', href: '/zh' },
  { label: 'åšå®¢', href: '/zh/blog' },
  { label: category.name, href: `/zh/blog/category/${slug}` },
];
---

<BaseLayout
  title={`${category.name} | è®¾å¤‡èèµ„åšå®¢ | æ°¸å…´ä¿¡è´·`}
  description={category.description}
  lang={lang}
  keywords={[category.name, 'è®¾å¤‡èèµ„', 'é©¬æ¥è¥¿äºš']}
>
  <!-- Breadcrumbs -->
  <section class="bg-gray-50 border-b border-gray-200">
    <div class="container-custom">
      <Breadcrumbs items={breadcrumbItems} />
    </div>
  </section>

  <!-- Category Header -->
  <section class="section bg-gradient-to-br from-primary/5 via-white to-secondary/5">
    <div class="container-custom text-center max-w-4xl mx-auto">
      <div class="text-6xl mb-4">{category.icon}</div>
      <h1 class="text-4xl md:text-5xl font-bold text-primary mb-4">
        {category.name}
      </h1>
      <p class="text-xl leading-relaxed" style="color: #2D1810;">
        {category.description}
      </p>
      <div class="mt-6 text-sm font-bold text-primary">
        {categoryPosts.length} ç¯‡æ–‡ç« 
      </div>
    </div>
  </section>

  <!-- Category Posts -->
  <section class="section">
    <div class="container-custom max-w-5xl mx-auto">
      {categoryPosts.length > 0 ? (
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          {categoryPosts.map((post) => (
            <div class="card h-full flex flex-col group hover:shadow-[8px_8px_0_#2D1810] transition-shadow duration-300">
              {/* Image Placeholder */}
              <a href={`/zh/blog/${post.slug}`} class="block overflow-hidden aspect-video bg-gradient-to-br from-gray-100 to-gray-200 relative">
                <div class="absolute inset-0 flex items-center justify-center text-5xl opacity-20">
                  {category.icon}
                </div>
              </a>

              <div class="card-body flex flex-col flex-grow">
                {/* Category Badge */}
                <div class="mb-3">
                  <span class="badge badge-primary text-xs">{category.name}</span>
                </div>

                {/* Title */}
                <h3 class="text-xl font-bold text-primary mb-3 group-hover:text-secondary transition-colors line-clamp-2">
                  <a href={`/zh/blog/${post.slug}`}>
                    {post.title}
                  </a>
                </h3>

                {/* Excerpt */}
                <p class="mb-4 flex-grow line-clamp-3 leading-relaxed" style="color: #2D1810;">
                  {post.excerpt}
                </p>

                {/* Footer */}
                <div class="flex items-center justify-between pt-4 border-t border-gray-200 text-sm">
                  <time datetime={post.date} class="text-gray-500">
                    {new Date(post.date).toLocaleDateString('zh-CN', { month: 'long', day: 'numeric' })}
                  </time>
                  <a
                    href={`/zh/blog/${post.slug}`}
                    class="text-secondary font-semibold hover:text-accent transition-colors"
                  >
                    é˜…è¯»æ›´å¤š â†’
                  </a>
                </div>
              </div>
            </div>
          ))}
        </div>
      ) : (
        <div class="card p-12 text-center">
          <div class="text-6xl mb-4">ğŸ“</div>
          <h2 class="text-2xl font-bold text-primary mb-4">æš‚æ— æ–‡ç« </h2>
          <p class="mb-6" style="color: #2D1810;">
            æˆ‘ä»¬æ­£åœ¨ä¸ºæ­¤ç±»åˆ«æ·»åŠ å†…å®¹ã€‚è¯·ç¨åå†å›æ¥æŸ¥çœ‹æˆ–æµè§ˆå…¶ä»–ç±»åˆ«ã€‚
          </p>
          <CTAButton
            text="æŸ¥çœ‹æ‰€æœ‰æ–‡ç« "
            link="/zh/blog"
            variant="primary"
            size="medium"
          />
        </div>
      )}

      {/* Back to Blog */}
      <div class="mt-12 text-center">
        <a
          href="/zh/blog"
          class="inline-flex items-center gap-2 text-secondary font-semibold hover:text-accent transition-colors"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
          </svg>
          è¿”å›æ‰€æœ‰æ–‡ç« 
        </a>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="section bg-gradient-to-r from-primary to-secondary text-white">
    <div class="container-custom text-center">
      <h2 class="text-3xl md:text-4xl font-bold mb-4">
        å‡†å¤‡å¥½ä¸ºæ‚¨çš„è®¾å¤‡èèµ„äº†å—ï¼Ÿ
      </h2>
      <p class="text-xl mb-8 opacity-90 max-w-2xl mx-auto">
        ä»é©¬æ¥è¥¿äºšå€¼å¾—ä¿¡èµ–çš„è®¾å¤‡èèµ„åˆä½œä¼™ä¼´ï¼ˆæˆç«‹äº1985å¹´ï¼‰è·å¾—ä¸“ä¸šå»ºè®®ã€‚
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <CTAButton
          text="ç«‹å³è·å–å…è´¹æŠ¥ä»·"
          link="/zh/contact"
          variant="accent"
          size="large"
        />
        <CTAButton
          text="è®¡ç®—æ¯æœˆè¿˜æ¬¾"
          link="/zh/calculator"
          variant="outline-white"
          size="large"
        />
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .badge {
    @apply inline-block px-3 py-1 rounded-full text-xs font-semibold;
  }

  .badge-primary {
    @apply bg-primary/10 text-primary;
  }

  .card {
    @apply bg-white rounded-lg shadow-[4px_4px_0_#2D1810] overflow-hidden;
  }

  .card-body {
    @apply p-6;
  }

  .container-custom {
    @apply max-w-7xl mx-auto px-4 sm:px-6 lg:px-8;
  }

  .section {
    @apply py-16 md:py-20;
  }
</style>
