---
import type { Locale } from '../utils/constants';
import { SITE_CONFIG } from '../utils/constants';
import { t, getLocalizedPath } from '../utils/i18n';
import LanguageSwitcher from './LanguageSwitcher.astro';

interface Props {
  lang: Locale;
  currentPath: string;
}

const { lang, currentPath } = Astro.props;
const translate = t(lang);

const navItems = [
  { label: translate('nav.home'), href: getLocalizedPath(lang, '') },
  { label: translate('nav.about'), href: getLocalizedPath(lang, 'about') },
  { label: translate('nav.services'), href: getLocalizedPath(lang, 'services') },
  { label: translate('nav.blog'), href: getLocalizedPath(lang, 'blog') },
  { label: translate('nav.contact'), href: getLocalizedPath(lang, 'contact') }
];
---

<header class="sticky top-0 z-50 bg-white/95 backdrop-blur-sm border-b border-gray-200 shadow-sm">
  <nav class="container-custom">
    <div class="flex items-center justify-between h-16">
      <!-- Logo -->
      <a href={getLocalizedPath(lang, '')} class="flex items-center space-x-2 group">
        <div class="w-10 h-10 bg-gradient-to-br from-primary-400 to-primary-600 rounded-lg flex items-center justify-center">
          <span class="text-white font-bold text-xl">R</span>
        </div>
        <span class="font-heading font-bold text-xl text-dark group-hover:text-primary-600 transition-colors">
          {SITE_CONFIG.name}
        </span>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center space-x-1">
        {navItems.map(item => (
          <a
            href={item.href}
            class={`px-4 py-2 rounded-md text-sm font-medium transition-colors ${
              currentPath.startsWith(item.href) && item.href !== `/${lang}/`
                ? 'bg-primary-50 text-primary-700'
                : currentPath === item.href
                ? 'bg-primary-50 text-primary-700'
                : 'text-gray-700 hover:bg-gray-50 hover:text-primary-600'
            }`}
          >
            {item.label}
          </a>
        ))}
      </div>

      <!-- Right Side Actions -->
      <div class="flex items-center space-x-4">
        <LanguageSwitcher currentLang={lang} currentPath={currentPath} />

        <a
          href={getLocalizedPath(lang, 'contact')}
          class="hidden md:inline-flex btn btn-primary"
        >
          {translate('cta.getStarted')}
        </a>

        <!-- Mobile Menu Button -->
        <button
          id="mobile-menu-button"
          class="md:hidden p-2 text-gray-700 hover:text-primary-600 transition-colors"
          aria-label="Toggle menu"
        >
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div
      id="mobile-menu"
      class="hidden md:hidden pb-4 pt-2 border-t border-gray-200"
    >
      <div class="flex flex-col space-y-2">
        {navItems.map(item => (
          <a
            href={item.href}
            class={`px-4 py-2 rounded-md text-sm font-medium transition-colors ${
              currentPath.startsWith(item.href) && item.href !== `/${lang}/`
                ? 'bg-primary-50 text-primary-700'
                : currentPath === item.href
                ? 'bg-primary-50 text-primary-700'
                : 'text-gray-700 hover:bg-gray-50'
            }`}
          >
            {item.label}
          </a>
        ))}
        <a
          href={getLocalizedPath(lang, 'contact')}
          class="btn btn-primary w-full mt-4"
        >
          {translate('cta.getStarted')}
        </a>
      </div>
    </div>
  </nav>
</header>

<script>
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');

  if (mobileMenuButton && mobileMenu) {
    mobileMenuButton.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });
  }
</script>
